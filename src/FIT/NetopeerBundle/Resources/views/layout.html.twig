<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="author" content="David Alexa - alexadav@fit.cvut.cz" />
	<meta name="robots" content="noindex, nofollow" /> 

	<link href="{{ asset('bundles/netopeer/style/pie.css') }}" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="{{ asset('bundles/netopeer/style/screen.css') }}" type="text/css" media="all" />
	{% block stylesheet %}{% endblock stylesheet %}

	<script type="text/javascript" src="{{ asset('bundles/netopeer/js/jquery-1.7.2.min.js')}} "></script>
	<script type="text/javascript" src="{{ asset('bundles/netopeer/js/jquery-ui-1.10.2.custom.min.js')}} "></script>
	<script type="text/javascript" src="{{ asset('bundles/netopeer/js/modernizr.custom.43627.js')}} "></script>
	<script type="text/javascript" src="{{ asset('bundles/netopeer/js/selectivizr-min.js')}} "></script>
	<script type="text/javascript" src="{{ asset('bundles/netopeer/js/tooltip/gips.js')}} "></script>
	<script type="text/javascript" src="{{ asset('bundles/netopeer/js/default.js')}} "></script>
	<script type="text/javascript" src="{{ asset('bundles/netopeer/js/notifications.js')}} "></script>
	{% block javascripts %}{% endblock javascripts %}

	<title>{% block title %}{% endblock title %} {% block additionalTitle %}| Project Netopeer{% endblock additionalTitle %}</title>
</head>
<body>

	{% if is_granted('IS_AUTHENTICATED_FULLY') %}
		<nav id="top">
			<a href="{{ path('_home') }}" title="Home" class="static ico-home header-icon {% if activeAction is defined and activeAction == "home" %}active{% endif %}"><span></span>Connections</a>
			{% if app.request.get('key') is defined and not (app.request.get('key') is empty) and lockedConn is defined %}
				{% if lockedConn == false %}
					<a href="{{ path("handleConnection", {"command": "lock", "key": app.request.get('key')} ) }}" title="Lock" class="static ico-unlock header-icon"><span></span></a>
				{% else %}
					<a href="{{ path("handleConnection", {"command": "unlock", "key": app.request.get('key')} ) }}" title="Unlock" class="static ico-lock header-icon"><span></span></a>
				{% endif %}
				<a href="{{ path("infoPage", {"key": app.request.get('key'), "action": "session"}) }}" title="Session info" class="static ico-session header-icon {% if activeAction is defined and activeAction == "session" %}active{% endif %}"><span></span></a>
				<a href="javascript:document.location.reload(true)" title="Refresh data" class="ico-refresh header-icon"><span></span></a>
				{% if topmenu is defined %}
					{% set i = 0 %}
					{% for section in topmenu %}
						<a href="{{ path(section.path, section.params) }}" title="{{section.title}} ({{section.namespace}})" class="dynamic {% if sectionName is defined and sectionName == section.name %}active{% endif %} nth-{{i}}">{{section.name}}<span class="arrow"></span></a>
						{% set i = i + 1 %}
					{% endfor %}
					<a href="{{ path("module", {"key":app.request.get('key'),"module":'all'} ) }}" class="dynamic {% if sectionName is defined and sectionName|lower == "all" %}active{% endif %}" title="GET all information">All<span class="arrow"></span></a>
				{% endif %}
			{% endif %}
			<div id="userpane" class="static">
				Logged user: <strong>{{ app.user.username }}</strong> 
				{% if is_granted('IS_AUTHENTICATED_FULLY') %}<a href="{{ path('_logout') }}" class="log-out">Log out</a>{% endif %}
			</div>
			<div class="others-cover">
				<div class="show-link header-icon ico-arrow-down">
					<span></span>
					<div class="others"></div>
				</div>
			</div>
		</nav>

		{% set addToColumnClass = '' %} {# nastaveni prazdne promenne, aby nedochazelo k vypisu nedefinovane promenne #}
		{# if submenu is defined and submenu #}
			<nav id="left">
				{% for subsection in submenu %}
					<a href="{{ path(subsection.path, subsection.params) }}" title="{{subsection.title}}" class="{% if subsectionName is defined and subsectionName == subsection.name %}active{% endif %}">{{subsection.name}}</a>
				{% endfor %}
				{% block leftColumn %}
				{% endblock leftColumn %}
			</nav>
			{% set addToColumnClass = ' left-nav-defined' %}
		{# endif #}

		{% block topPart %}
		{% endblock topPart %}

		<div class="alert-cover">
			{% if allFlashes|length %}
				{% for type, message in allFlashes %}
						<div class='alert {{type}}'><span class="close">X</span>{{message|raw}}</div>
					{% endfor %}
			{% endif %}
		</div>

		{% if singleColumnLayout == false %}
			<section id="state" class="column{{addToColumnClass}}">
				{% for type, message in stateInfoFlashes %}
				    <div class='alert {{type}}'>{{message|raw}}</div>
				{% endfor %}

				{% block state %}
				{% endblock state %}
			</section>
			<section id="config" class="column{{addToColumnClass}}">

				{% for type, message in configInfoFlashes %}
				    <div class='alert {{type}}'>{{message|raw}}</div>
				{% endfor %}

				{% block config %}
				{% endblock config %}
			</section>
		{% else %}
			<section id="content" class="{{addToColumnClass}}{% block singleContentClass %}{% endblock singleContentClass %}">

				{% for type, message in allInfoFlashes %}
					<div class='alert {{type}}'>{{message|raw}}</div>
				{% endfor %}

				{% block singleContent %}
				{% endblock singleContent %}
			</section>
		{% endif %}

	{% else %}
		<nav id="top">
			<a href="{{ path('_home') }}" title="Home" id="ico-home"></a>
		</nav>

		<article id="content">
			{% block flashes %}
				{% for type, message in allFlashes %}
					<div class='alert {{type}}'>{{message|raw}}</div>
				{% endfor %}
			{% endblock flashes %}	

			{% block content %}
			{% endblock content %}


		</article>
	{% endif %}	

{% if app.request.get('key') is defined and not (app.request.get('key') is empty) and lockedConn is defined %}
<div id="notif-bar" style="position: fixed; bottom:30px; right: 0px;">Notifications: <button onClick="notifWebSocket();">Connect</button><button onClick="doSend('{% if sessionHash is defined %}{{sessionHash}}{% endif %} -10 0');">Start</button><div id="notif-output" style="overfow: scroll;"></div></div>
{% endif %}
</body>
</html>
